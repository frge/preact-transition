!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("preact")):"function"==typeof define&&define.amd?define(["preact"],n):t.preactTransition=n(t.preact)}(this,function(f){"use strict";var v=/\b(transform|all)(,|$)/,c=Object.prototype.hasOwnProperty,m="transition",l="animation",h="transition",p="transitionend",y="animation",d="animationend";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(h="WebkitTransition",p="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(y="WebkitAnimation",d="webkitAnimationEnd");var w=window.requestAnimationFrame?window.requestAnimationFrame.bind(window):"function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function b(n,t,e){var o=function(t,n){var e,o=window.getComputedStyle(t),i=o[h+"Delay"].split(", "),r=o[h+"Duration"].split(", "),a=g(i,r),s=o[y+"Delay"].split(", "),u=o[y+"Duration"].split(", "),f=g(s,u),c=0,p=0;n===m?0<a&&(e=m,c=a,p=r.length):n===l?0<f&&(e=l,c=f,p=u.length):(c=Math.max(a,f),p=(e=0<c?f<a?m:l:null)?e===m?r.length:u.length:0);var d=e===m&&v.test(o[h+"Property"]);return{type:e,timeout:c,propCount:p,hasTransform:d}}(n,t),i=o.type,r=o.timeout,a=o.propCount;if(!i)return e(i);var s=i===m?p:d,u=0;function f(){n.removeEventListener(s,c),e(i)}function c(t){t.target===n&&++u>=a&&f()}setTimeout(function(){u<a&&f()},r+1),n.addEventListener(s,c)}function g(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max.apply(null,t.map(function(t,n){return o(t)+o(e[n])}))}function o(t){return 1e3*Number(t.slice(0,-1))}function D(t){return"function"==typeof t}function O(){}var M=["enter","enter-active","enter-to","leave","leave-active","leave-to"],T=["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"],E=T.concat(["type"],["mode"],["appear"],["tag"],["ref"],["name"],["css"]);function k(o,t,n){var e=o.setState.bind(o),i="enter"===t?0:3,r=o.props.css;function a(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var e=o.props[T[i]];if(D(e))return e.apply(void 0,[o.DOM].concat(t))}function s(){e({transfer:++i},function(){w(a),n&&w(function(){return n()})})}function u(){e({transfer:++i},function(){r?b(o.DOM,o.props.type,function(t){a(O),t===m||t===l?s():w(s)}):a(function(t){t!==+t?w(s):setTimeout(s,t)})})}function f(){a(),w(u)}void 0===r&&(r=!0),e({transfer:i},function(){w(f)})}return function(n){function t(t){n.call(this,t),this.state.transfer=-1,this.state.mode=void 0,this.DOM=null}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.componentDidMount=function(){var t=this,n=this.props,e=n.mode;void 0===e&&(e="in");var o=n.appear;void 0===o&&(o=!1);var i,r,a,s,u="in"===e,f=function(){return t.setState({mode:e})};o?k(this,u?"enter":"leave",f):(r=f,a="enter"===(u?"enter":"leave")?2:5,s=(i=this).props[T[a]],i.setState({transfer:a},function(){D(s)&&w(function(){return s(i.DOM,!0)}),D(r)&&w(function(){return r()})}))},t.prototype.componentWillReceiveProps=function(t){var n=this,e=t.mode;if(e&&e!==this.state.mode){var o=function(){return n.setState({mode:e})};k(this,"in"===e?"enter":"leave",o)}},t.prototype.render=function(t,n){var e=this,o=n.transfer;void 0===o&&(o=-1);var i=t.ref,r=t.name;void 0===r&&(r="t");var a=t.css;void 0===a&&(a=!0);var s=function(t,n){var e,o,i={};for(var r in t)e=t,o=r,c.call(e,o)&&-1===n.indexOf(r)&&(i[r]=t[r]);return i}(t,E);s.ref=function(t){D(i)&&i(t),e.DOM=t&&function t(n){return n.base&&n.base.nodeType&&n.base.nodeName?t(n.base):n}(t)},a&&M[o]&&(s.className=[s.className,r+"-"+M[o]].filter(Boolean).join(" "));var u=t.component;return void 0===u&&(u=t.tag),f.h(u||"div",s)},t}(f.Component)});
