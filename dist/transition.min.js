!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("preact")):"function"==typeof define&&define.amd?define(["preact"],n):t.preactTransition=n(t.preact)}(this,function(u){"use strict";var v=/\b(transform|all)(,|$)/,f=Object.prototype.hasOwnProperty,l="transition",m="animation",h="transition",p="transitionend",y="animation",d="animationend";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(h="WebkitTransition",p="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(y="WebkitAnimation",d="webkitAnimationEnd");var c=window.requestAnimationFrame?window.requestAnimationFrame.bind(window):"function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function w(n,t,e){var o=function(t,n){var e,o=window.getComputedStyle(t),i=o[h+"Delay"].split(", "),r=o[h+"Duration"].split(", "),a=b(i,r),s=o[y+"Delay"].split(", "),u=o[y+"Duration"].split(", "),f=b(s,u),c=0,p=0;n===l?0<a&&(e=l,c=a,p=r.length):n===m?0<f&&(e=m,c=f,p=u.length):(c=Math.max(a,f),p=(e=0<c?f<a?l:m:null)?e===l?r.length:u.length:0);var d=e===l&&v.test(o[h+"Property"]);return{type:e,timeout:c,propCount:p,hasTransform:d}}(n,t),i=o.type,r=o.timeout,a=o.propCount;if(!i)return e(i);var s=i===l?p:d,u=0;function f(){n.removeEventListener(s,c),e(i)}function c(t){t.target===n&&++u>=a&&f()}setTimeout(function(){u<a&&f()},r+1),n.addEventListener(s,c)}function b(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max.apply(null,t.map(function(t,n){return o(t)+o(e[n])}))}function o(t){return 1e3*Number(t.slice(0,-1))}function g(t){return"function"==typeof t}function D(){}var O=["enter","enter-active","enter-to","leave","leave-active","leave-to"],M=["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"],T=M.concat(["type"],["mode"],["appear"],["tag"],["ref"],["name"],["css"]);function E(o,t,n){var e=o.setState.bind(o),i="enter"===t?0:3,r=o.props.css;function a(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var e=o.props[M[i]];if(g(e))return e.apply(void 0,[o.DOM].concat(t))}function s(){e({transfer:++i},function(){c(a),n&&c(function(){return n()})})}function u(){e({transfer:++i},function(){r?w(o.DOM,o.props.type,function(t){a(D),t===l||t===m?s():c(s)}):a(function(t){t!==+t?c(s):setTimeout(s,t)})})}function f(){a(),c(u)}void 0===r&&(r=!0),e({transfer:i},function(){c(f)})}return function(n){function t(t){n.call(this,t),this.state.transfer=-1,this.state.mode=void 0,this.DOM=null}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.componentDidMount=function(){var t=this,n=this.props,e=n.mode;void 0===e&&(e="in");var o=n.appear;void 0===o&&(o=!1);var i,r,a,s,u="in"===e,f=function(){return t.setState({mode:e})};o?E(this,u?"enter":"leave",f):(r=f,a="enter"===(u?"enter":"leave")?2:5,s=(i=this).props[M[a]],i.setState({transfer:a},function(){g(s)&&c(function(){return s(i.DOM,!0)}),g(r)&&c(function(){return r()})}))},t.prototype.componentWillReceiveProps=function(t){var n=this,e=t.mode;if(e&&e!==this.state.mode){var o=function(){return n.setState({mode:e})};E(this,"in"===e?"enter":"leave",o)}},t.prototype.render=function(t,n){var e=this,o=n.transfer;void 0===o&&(o=-1);var i=t.ref,r=t.name;void 0===r&&(r="t");var a=t.css;void 0===a&&(a=!0);var s=function(t,n){var e,o,i={};for(var r in t)e=t,o=r,f.call(e,o)&&-1===n.indexOf(r)&&(i[r]=t[r]);return i}(t,T);return s.ref=function(t){g(i)&&i(t),e.DOM=function t(n){return n.base&&n.base.nodeType&&n.base.nodeName?t(n.base):n}(t)},a&&O[o]&&(s.className=[s.className,r+"-"+O[o]].filter(Boolean).join(" ")),u.h(t.tag||"div",s)},t}(u.Component)});
